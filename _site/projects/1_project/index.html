<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>ICR - Identifying Age-Related Conditions | Nayoung Bae</title>
    <meta name="author" content="Nayoung Bae">
    <meta name="description" content="a project with a background image">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04">
    <!-- <link rel="stylesheet" href="/al-folio/assets/css/mdb.min.css?62a43d1430ddb46fc4886f9d0e3b49b8"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light">

    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
    <link rel="canonical" href="http://localhost:4000/al-folio/projects/1_project/">

    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark">
    <script src="/al-folio/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script>
    <script src="/al-folio/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/al-folio/"><span class="font-weight-bold">You </span>R. Name</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/repositories/">repositories</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/cv/">cv</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/teaching/">teaching</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/al-folio/people/">people</a>
              </li>
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/al-folio/publications/">publications</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/al-folio/projects/">projects</a>
                </div>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      
        <!-- page.html -->
<div class="post">

  <header class="post-header">
    <h1 class="post-title">ICR - Identifying Age-Related Conditions</h1>
    <!-- <p class="post-description">a project with a background image</p> -->
  </header>

  <article>
    <p>ICR - Identifying Age-Related Conditions은 Kaggle 대회로 주어진 데이터셋을 활용해 노화질병 여부가 있는지 예측하는 모델을 구축하는 것이 목표입니다. </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <b>기간: 2023.06.19(월) ~ 2023.06.30(금)
    팀원: 5명
    역할: 팀장 및 발표</b>

</code></pre></div></div>
<br>
<h2>Dataset 데이터셋</h2>
<div class = "데이터셋설명">
    <p>
        <b>train.csv</b>, <b>test.csv</b>, 메타데이터인 <b>greeks.csv</b>가 주어졌습니다.
    </p>

    <h3>train.csv</h3>

      <picture>
    
    <!-- <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
     -->

    <!-- Fallback to the original file -->
    <img src="/al-folio/assets/img/kaggle_icr/pjt_kag_icr-train-head.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture> 

  <br><br>
  <div class = "plain설명">
    <p>
        <b>train.csv</b>은 총 58개의 비식별화된 컬럼으로 주어졌으며 617개의 rows로 이루어져 있습니다. 이중 <b>EJ</b> 컬럼은 범주형 컬럼으로 'A'와 'B' 값을 가집니다. 
        이 중 train의 <b>Target</b> 컬럼이 대회에서 예측해야 할 binary class인 노화관련질병을 나타냅니다.
    </p>
    </div>

    <!--test csv-->
    <h3>test.csv</h3>

    <picture>
  
  <!-- <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
  <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
  <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
   -->

  <!-- Fallback to the original file -->
  <img src="/al-folio/assets/img/kaggle_icr/pjt_kag_icr-test-head.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
</picture> 

<br><br>
    <div class = "plain설명">
    <p>
        <b>test.csv</b>은 총 57개의 비식별화된 컬럼으로 주어졌으며 5개의 rows로 이루어져 있습니다. 

    </p>
    </div>


        <!--greeks csv-->
        <h3>greeks.csv</h3>

        <picture>
      
      <!-- <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
      <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
      <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/Users/baenayoung/Desktop/nayoung511.github.io/_site/assets/img/pjt_kag_icr-train-head.png"></source>
       -->
    
      <!-- Fallback to the original file -->
      <img src="/al-folio/assets/img/kaggle_icr/icr-greeks.png" class="img-fluid rounded z-depth-1" width="50%" height="50%" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
    </picture> 
    
    <br><br>
        <div class = "plain설명">
        <p>
            <b>greeks.csv</b>는 메타데이터로 <b>Alpha</b> 컬럼은 노화관련질병의 종류를, <b>Beta, Gamma, Delta</b>는 3가지의 실험적 특성을 나타냅니다. <b>Epsilon</b>은 데이터가 수집된 날짜를 보여줍니다. 
        </p>
        </div>
</div>


<br>
<hr>

<div class="EDA">
    <h2>EDA</h2>
    <!--결측치-->
    <div class="missing_value">
        <h3>1. 결측치</h3>
        <img src="/al-folio/assets/img/kaggle_icr/icr-missing-train.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">    
        <br><br>
        <p>
            <b>train.csv</b> 중 결측치를 가지는 컬럼은 총 9개입니다. 
            그 중 <b>BQ</b>와 <b>EL</b> 컬럼이 60개의 결측치를 가지고 있습니다.
        </p>
    </div>

    <!--이상치-->
    <br><br>
    <div class="outliers_value">
        <h3>2. 이상치</h3>
        <p>
            <b>train.csv</b> 57개의 컬럼들의 이상치를 Boxplot으로 표현해 보았습니다. 
            <div class = "term_explanation" style="background-color:#EBF5F7">
                <p>
                    <b>Boxplot(상자 그림)</b>은 데이터 분포의 중앙값, 사분위수, 이상치를 시각적으로 표현하는 통계적 그래픽 방법입니다.
                    <br><br><b>Boxplot의 주요 구성 요소:</b>
                    <ul>
                        <li>상자 (Box): 상자는 데이터의 중앙값인 중앙사분위수(Q2 또는 2사분위수)를 나타냅니다. 중앙사분위수는 데이터를 4분위로 나눌 때 데이터의 중간에 위치한 값으로 데이터의 중심 위치를 나타냅니다. 상자의 윗부분과 아랫부분은 각각 상단사분위수(Q3)와 하단사분위수(Q1)를 나타냅니다.</li>

                        <li>수염 (Whiskers): 수염은 데이터의 분포를 나타냅니다. 주로 상자의 윗부분과 아랫부분에서 시작하여 상자 외부의 가장 극단적인 데이터 포인트까지 이어지는 선입니다. 수염의 길이는 데이터의 분산 정도를 나타내며, 이상치의 존재 여부도 확인할 수 있습니다.</li>
                        
                        <li>이상치 (Outliers): 이상치는 주로 수염 부분을 벗어나는 데이터 포인트를 나타냅니다. 이상치는 데이터 분포에서 비정상적으로 크거나 작은 값으로 간주되는 데이터를 가리킵니다.</li>
                        
                        <li>중앙값 (Median): 상자 안에 위치한 가로선 또는 점은 데이터의 중앙값을 나타냅니다. 중앙값은 데이터를 오름차순으로 정렬했을 때 중간에 위치한 값으로, 데이터의 중심 위치를 나타냅니다.</li>
                        
                    </ul>
                </p>
            </div>
        </p>
        <img src="/al-folio/assets/img/kaggle_icr/icr-outliers.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">    

        <br><br>

        <p>
            조금 더 직관적으로 판단하기 위해 IQR 방법으로 사용해 IQR 25%이하, 75% 이상의 데이터를 파이차트로 표현해 보았습니다. 
        </p>

        <img src="/al-folio/assets/img/kaggle_icr/icr-outliers-percent.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">    

        <br><br>

        <p>
            전체 데이터셋의 이상치를 파이차트로 확인하면 약 40.44% 정도가 이상치라고 판별할 수 있습니다.
        </p>

        <img src="/al-folio/assets/img/kaggle_icr/icr-outliers-percent-total.png" class="img-fluid rounded z-depth-1" width="50%" height="50%" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">    

    </div>

</div> <!--End of EDA Class-->

<br>
<br>
<hr>

<div class = "datapreprocessing">
    <h2>Data Preprocessing</h2>
    <div class="missing_value_filling">
        <h3>1. 결측치 채우기</h3>
        <p>
            결측치를 채우는데 있어 
            <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px">
                <b>1. median, mean으로 채우기</b>
            </span>와
            <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px">
                <b>2. KNNImputer로 채우기</b>
            </span>를 시도해 보았습니다.
        </p>
        <br>
        <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px; font-size:24px">
            <b>1. median, mean으로 채우기</b>
        </span>
        
        <ul>
            <br>
            <li>EDA를 통해 각 컬럼의 데이터들은 비대칭 분포를 가지고 있다는 것을 알 수 있습니다.</li>
            <li>즉, 균등하지 못한 데이터를 가지고 있는 상태에서 전체 데이터를 고려하는 median, mean으로 결측치를 채우는 것은 데이터가 가지는 비대칭성을 더 극대화하였습니다.</li>
        </ul>
            
        <br>
        <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px; font-size:24px">
            <b>2.KNNImputer로 채우기</b>
        </span>
        
        <br>
        K-Nearest Neighbors(KNN) 알고리즘 기반의 KNNImputer 방법으로 주변 N개의 데이터를 고려하여 결측치를 채우는 방법입니다.
        <ul>
            <br>
            <li>KNNImputer는 주변 데이터 값들과의 유사성을 고려해 주변 데이터 값의 가중 평균으로 채웁니다.</li>
            <ul>
                <li>데이터 특정을 더 정확하게 모델링 할 수 있습니다.</li>
            </ul>
                
        </ul>
            
    </div>
    <br>
    <div class="outlier_handling">
        <h3>2. 이상치 처리</h3>
        <p>
            이상치 처리로는
            <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px">
                <b>1. IQR을 이용해 IQR 25% 이하, 1QR 75% 이상 삭제</b>
            </span>,
            <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px">
                <b>2. RobustScaler 사용</b>
            </span>와
            <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px">
                <b>3. 이상치 처리하지 않기</b>
            </span>를 시도해 보았습니다.
        </p>

        <br>
        <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px; font-size:24px">
            <b>1. IQR을 이용해 IQR 25% 이하, 1QR 75% 이상 삭제</b>
        </span>
        
        <ul>
            <br>
            <li>단순한 이상치 처리 방법인 IQR을 사용하여 데이터의 중앙값인 Q2를 넘어가는 값을 제거하는 방법을 시도했습니다.</li>
            <li>하지만 IQR방법은 데이터의 중앙값을 기반으로 작동하기에 ICR 데이터와 같이 이상치가 꼬리 부분에 위치하는 경우 잘 동작하지 않는다는 단점이 있었습니다. </li>
        </ul>
        <br>
        
        <br>
        <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px; font-size:24px">
            <b>2. RobustScaler 사용</b>
        </span>
        
        <ul>
            <br>
            <li>obustScaler는 데이터를 중앙값(median)과 IQR(Interquartile Range)를 사용하여 스케일 조정합니다.</li>
            <li>이 방식은 데이터의 중간에 이상치가 있더라도 이상치가 스케일 조정에 큰 영향을 미치지 않도록 합니다.</li>
            <li>따라서 RobustScaler를 사용하면 데이터의 분포를 이동시키고 스케일을 조정함으로써 이상치에 영향을 덜 받을 수 있습니다.</li>
        </ul>
        <br>

        <br>
        <span style="background-color:#E0EEFF; color:#1063C7 ; padding: 5px; border-radius: 50px; font-size:24px">
            <b>3. 이상치 처리하지 않기</b>
        </span>
        
        <p>굳이...처리 해야할까요..?</p>
        <br>



    </div> <!--이상치 처리 끝-->

</div>


<br>
<br>
<hr>

<div class = "Modelling">
    <h2>Modelling</h2>
    (머신러닝 프로젝트의 일환으로 딥러닝 모델보다는 머신러닝을 통해 모델링을 하는 것에 초점을 두었습니다.)
    
    <div class ="LightGBM">
        <br>
        <h3>LightGBM</h3>
        LightGBM이 가지는 두드러지는 장점은,
        <ul>
            <li><b>카테고리 변수 자동 처리</b>: LightGBM는 범주형 변수(카테고리 변수)를 자동으로 처리할 수 있는 기능을 제공합니다. 따라서 데이터를 원-핫 인코딩이나 레이블 인코딩으로 변환할 필요가 없으며, 이로 인해 데이터 전처리 단계에서 시간을 절약할 수 있습니다.</li>
            <li><b>규모와 메모리 효율성</b>: LightGBM은 대용량 데이터셋에서도 빠른 속도와 메모리 효율성을 제공합니다. 이는 그래디언트 부스팅 알고리즘 중에서도 가장 효율적으로 동작하는 것 중 하나이며, 대규모 데이터를 처리하거나 메모리 제한이 있는 환경에서 유용합니다.</li>
        </ul>

        (설명 더 주저리주저리)
        

        <figure class="highlight"><pre><code class="python" data-lang="python"><table class="rouge-table"><tbody><tr>
            <td class="gutter gl"><pre class="lineno">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
        </pre></td>
        <td class="code"><pre><span class="c"># repeated kfold</span>
    <span class="k">for</span> <span class="n">bag</span> <span class="k">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bag_num</span><span class="p">):</span>
        <span class="c"># 배깅 앙상블 기법 사용</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'########################## bag: {bag} ##########################'</span><span class="p">)</span>
        <span class="c"># fold를 5개로 나누고 random_state를 바꾸어가면서 스플릿하는 fold의 기준을 바꾸어가면서 돌린다.</span>
        <span class="n">kf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_fold</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span> <span class="o">*</span> <span class="n">bag</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">models</span><span class="p">[</span><span class="n">bag</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># greeks의 Alpha기준으로 분포를 정한다.</span>
        <span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span><span class="p">)</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">greeks</span><span class="p">[</span><span class="s">'Alpha'</span><span class="p">])):</span>
    
            <span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">(</span><span class="n">train_idx</span><span class="p">)</span>
            <span class="n">valid_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">(</span><span class="n">test_idx</span><span class="p">)</span>
            <span class="n">valid_ids</span> <span class="o">=</span> <span class="n">valid_df</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">feas_cols</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s">'Class'</span><span class="p">]</span>
            <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">valid_df</span><span class="p">[</span><span class="n">feas_cols</span><span class="p">],</span> <span class="n">valid_df</span><span class="p">[</span><span class="s">'Class'</span><span class="p">]</span>
    
            <span class="n">lgb</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">lgbm_params</span><span class="p">)</span>
    
            <span class="n">lgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">eval_set</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">eval_metric</span><span class="o">=</span><span class="n">lgb_metric</span><span class="p">)</span>
            
            <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">feature_importances_</span>
            <span class="n">feature_importance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Feature'</span><span class="p">:</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s">'Split'</span><span class="p">:</span> <span class="n">feature_importances</span><span class="p">,</span> <span class="s">'Gain'</span><span class="p">:</span> <span class="n">lgb</span><span class="o">.</span><span class="n">booster_</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">(</span><span class="n">importance_type</span><span class="o">=</span><span class="s">'gain'</span><span class="p">)})</span>
            <span class="n">feature_importance_df</span><span class="p">[</span><span class="s">'bag'</span><span class="p">]</span> <span class="o">=</span> <span class="n">bag</span>
            <span class="n">feature_importance_df</span><span class="p">[</span><span class="s">'fold'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fold</span>
            
            <span class="n">feature_importance_df_total</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">feature_importance_df_total</span><span class="p">,</span> <span class="n">feature_importance_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
    
            <span class="n">logloss</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
            <span class="n">balanced_logloss</span> <span class="o">=</span> <span class="n">balanced_log_loss</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">log_losses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">logloss</span><span class="p">)</span>
            <span class="n">balanced_log_losses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">balanced_logloss</span><span class="p">)</span>
            
            <span class="n">models</span><span class="p">[</span><span class="n">bag</span><span class="p">]</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lgb</span><span class="p">)</span>
    
            <span class="k">print</span><span class="p">(f"Bags: {bag}, Fold: {fold}, log loss: {round(logloss, 3)}, balanced log loss: {round(balanced_logloss, 3)}")</span>
    
        </pre></td>
        </tr></tbody></table></code></pre></figure>

        <hr>
        <div class="output">
            ########################## bag: 0 ########################## <br>
            Bags: 0, Fold: 0, log loss: 0.225, balanced los loss: 0.159<br>
            Bags: 0, Fold: 1, log loss: 0.103, balanced los loss: 0.057<br>
            Bags: 0, Fold: 2, log loss: 0.237, balanced los loss: 0.172<br>
            Bags: 0, Fold: 3, log loss: 0.234, balanced los loss: 0.132<br>
            Bags: 0, Fold: 4, log loss: 0.216, balanced los loss: 0.119<br>
            ########################## bag: 1 ##########################<br>
            Bags: 1, Fold: 0, log loss: 0.248, balanced los loss: 0.171<br>
            Bags: 1, Fold: 1, log loss: 0.203, balanced los loss: 0.145<br>
            Bags: 1, Fold: 2, log loss: 0.025, balanced los loss: 0.027<br>
            Bags: 1, Fold: 3, log loss: 0.234, balanced los loss: 0.116<br>
            Bags: 1, Fold: 4, log loss: 0.19, balanced los loss: 0.125<br>
            ########################## bag: 2 ##########################<br>
            Bags: 2, Fold: 0, log loss: 0.224, balanced los loss: 0.135<br>
            Bags: 2, Fold: 1, log loss: 0.159, balanced los loss: 0.103<br>
            Bags: 2, Fold: 2, log loss: 0.109, balanced los loss: 0.097<br>
            Bags: 2, Fold: 3, log loss: 0.19, balanced los loss: 0.147<br>
            Bags: 2, Fold: 4, log loss: 0.207, balanced los loss: 0.12<br>
            ########################## bag: 3 ##########################<br>
            Bags: 3, Fold: 0, log loss: 0.211, balanced los loss: 0.145<br>
            Bags: 3, Fold: 1, log loss: 0.194, balanced los loss: 0.091<br>
            Bags: 3, Fold: 2, log loss: 0.078, balanced los loss: 0.072<br>
            Bags: 3, Fold: 3, log loss: 0.279, balanced los loss: 0.171<br>
            Bags: 3, Fold: 4, log loss: 0.233, balanced los loss: 0.16<br>
            ########################## bag: 4 ##########################<br>
            ...<br>
            Bags: 19, Fold: 1, log loss: 0.251, balanced los loss: 0.124<br>
            Bags: 19, Fold: 2, log loss: 0.156, balanced los loss: 0.126<br>
            Bags: 19, Fold: 3, log loss: 0.117, balanced los loss: 0.059<br>
            Bags: 19, Fold: 4, log loss: 0.156, balanced los loss: 0.121</div>
</div>



<br>
<br>
<hr>
<div class="parameterTuning">
    <h2>하이퍼파라미터 튜닝</h2>
    <p>옵튜나를 사용하여 LightGBM 모델의 하이퍼파라미터 튜닝을 진행했습니다. </p>
    <br>
    <figure class="highlight">
        <pre>
          <code class="python" data-lang="python">
            <table class="rouge-table">
              <tbody>
                <tr>
                  <td class="gutter gl"><pre class="lineno">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
      </pre></td>
                  <td class="code"><pre>
      <span class="nx">lgbm_params</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">'boosting_type'</span><span class="p">:</span> <span class="s1">'goss'</span><span class="p">,</span>
          <span class="s1">'learning_rate'</span><span class="p">:</span> <span class="mf">0.06733232950390658</span><span class="p">,</span>
          <span class="s1">'n_estimators'</span><span class="p">:</span> <span class="mi">50000</span><span class="p">,</span>
          <span class="s1">'early_stopping_round'</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
          <span class="s1">'random_state'</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
          <span class="s1">'subsample'</span><span class="p">:</span> <span class="mf">0.6970532011679706</span><span class="p">,</span>
          <span class="s1">'colsample_bytree'</span><span class="p">:</span> <span class="mf">0.6055755840633003</span><span class="p">,</span>
          <span class="s1">'class_weight'</span><span class="p">:</span> <span class="s1">'balanced'</span><span class="p">,</span>
          <span class="s1">'metric'</span><span class="p">:</span> <span class="s1">'none'</span><span class="p">,</span>
          <span class="s1">'is_unbalance'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
          <span class="s1">'max_depth'</span><span class="p">:</span> <span class="mi">8</span>
      <span class="p">}</span>
            </pre></td>
                </tr>
              </tbody>
            </table>
          </code>
        </pre>
      </figure>
      
</div>

<br>
<br>
<hr>
<div class="결과">
    <h2>결과</h2>
</div>

<br>
<br>
<hr>
<div class="reflections">
    <h2> 배운 점과 더 발전할 수 있는 부분</h2>
    <p>ICR 대회를 통해 데이터 과학 및 머신 러닝의 세계로 한 발짝 더 들어가보았습니다. 이 대회를 통해 얻은 경험과 교훈은 정말 값진 것이었습니다. 여기에 제가 배운 주요 점들을 공유하고자 합니다.</p>
    
    <ol>
        <li>
            <strong>캐글 대회 참여 방법 숙지</strong>: ICR 대회에 참여하면서 캐글 대회에 어떻게 참여해야 하는지에 대한 기본적인 지식을 습득했습니다. 데이터셋을 이해하고 대회 목표를 분석하는 것은 중요한 출발점이었습니다.
        </li>
        <li>
            <strong>베이스라인과 인사이트 표현</strong>: 베이스라인 모델을 찾는 방법과 사람들의 인사이트를 코드로 표현하는 법을 배웠습니다. 다른 참가자들의 노하우와 코드를 살펴보며 새로운 아이디어를 얻었고, 이를 활용하여 성능을 향상시킬 수 있었습니다.
        </li>
        <li>
            <strong>최적화를 향해 실험</strong>: 여러 실험을 통해 어떤 방법이 최적의 방법인지 찾는 법을 배웠습니다. 하이퍼 파라미터 조정, 특성 엔지니어링, 모델 스태킹 등을 시도하며 경험을 쌓았습니다.
        </li>
        <li>
            <strong>다양한 기법 습득</strong>: ICR 대회를 통해 다양한 데이터 과학 및 머신 러닝 기법을 습득하였습니다. 예를 들어, fold 기법을 다양한 상황에 맞게 활용할 수 있다는 것도 깨달았으며, 데이터를 효과적으로 다루는 방법들을 배우는 계기가 되었습니다.
        </li>
    </ol>
    
    <p>팀원들과의 역할 분담은 데이터 과학 및 머신 러닝 프로젝트에서 중요한 부분 중 하나입니다. ICR 대회를 통해 우리는 각자의 강점을 살려 역할을 분담하였고, 결과적으로 다양한 실험과 방법을 시도할 수 있었습니다. 이러한 역할 분담을 통해 모든 멤버가 주어진 시간 내에 최대한 다양한 실험을 수행하고 효율적으로 작업을 완료할 수 있었습니다. 팀원 간의 원활한 소통과 협업은 프로젝트의 성공에 중요한 역할을 하였으며, 다양한 기법과 아이디어를 결합하여 최적의 결과를 얻는 데 도움을 주었습니다.</p>
    
    <p>ICR 대회를 통해 나만의 캐글 여정을 시작하게 된 것은 정말 큰 성과이자, 계속해서 배우고 성장해 나가는 기회로 삼고 있습니다. 앞으로도 더 많은 경진대회에 참여하며 데이터 과학의 세계에서 계속해서 발전해 나갈 계획입니다.</p>
    
</div>

<br>
<br>
<br>
<br>
<br>

<br>
<br>
<br>
<br>
<br>

<br>
<br>
<br>
<br>
<br>
<br>


  <h2>References</h2>
  <div class="publications">
    <h2 class="bibliography">1956</h2>
<ol class="bibliography"><li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="col-sm-2 preview">
<figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/al-folio/assets/img/publication_preview/brownian-motion.gif-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/al-folio/assets/img/publication_preview/brownian-motion.gif-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/al-folio/assets/img/publication_preview/brownian-motion.gif-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/al-folio/assets/img/publication_preview/brownian-motion.gif" class="preview z-depth-1 rounded" width="auto" height="auto" alt="brownian-motion.gif" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>
</div>
<!-- Entry bib key -->
        <div id="einstein1956investigations" class="col-sm-8">
        <!-- Title -->
        <div class="title">Investigations on the Theory of the Brownian Movement</div>
        <!-- Author -->
        <div class="author">
        

        <em>Albert Einstein</em>
</div>

        <!-- Journal/Book title and date -->
        
        
        <div class="periodical">
          1956
        </div>
        <div class="periodical">
          
        </div>

          <!-- Links/Buttons -->
          <div class="links">
            <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a>
          </div>
          
          
          
          

          <!-- Hidden bibtex block -->
          <div class="bibtex hidden">
            <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@book</span><span class="p">{</span><span class="nl">einstein1956investigations</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Investigations on the Theory of the Brownian Movement}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Einstein, Albert}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{1956}</span><span class="p">,</span>
  <span class="na">publisher</span> <span class="p">=</span> <span class="s">{Courier Corporation}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure>
          </div>
        </div>
      </div>
</li></ol>
<h2 class="bibliography">1950</h2>
<ol class="bibliography"><li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="col-sm-2 abbr"><abbr class="badge" style="background-color:#00369f"><a href="https://aapt.scitation.org/journal/ajp" rel="external nofollow noopener" target="_blank">AJP</a></abbr></div>
<!-- Entry bib key -->
        <div id="einstein1950meaning" class="col-sm-8">
        <!-- Title -->
        <div class="title">The meaning of relativity</div>
        <!-- Author -->
        <div class="author">
        

        <em>Albert Einstein</em>, and AH Taub</div>

        <!-- Journal/Book title and date -->
        
        
        <div class="periodical">
          <em>American Journal of Physics</em>, 1950
        </div>
        <div class="periodical">
          
        </div>

          <!-- Links/Buttons -->
          <div class="links">
            <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a>
          </div>
          
          
          
          

          <!-- Hidden bibtex block -->
          <div class="bibtex hidden">
            <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@article</span><span class="p">{</span><span class="nl">einstein1950meaning</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{The meaning of relativity}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Einstein, Albert and Taub, AH}</span><span class="p">,</span>
  <span class="na">journal</span> <span class="p">=</span> <span class="s">{American Journal of Physics}</span><span class="p">,</span>
  <span class="na">volume</span> <span class="p">=</span> <span class="s">{18}</span><span class="p">,</span>
  <span class="na">number</span> <span class="p">=</span> <span class="s">{6}</span><span class="p">,</span>
  <span class="na">pages</span> <span class="p">=</span> <span class="s">{403--404}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{1950}</span><span class="p">,</span>
  <span class="na">publisher</span> <span class="p">=</span> <span class="s">{American Association of Physics Teachers}</span>
<span class="p">}</span></code></pre></figure>
          </div>
        </div>
      </div>
</li></ol>
  </div>
</div>

      
    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Nayoung Bae. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="/al-folio/assets/js/mdb.min.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/al-folio/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/al-folio/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script>

  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/al-folio/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script>
  <script defer src="/al-folio/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script>
  <script defer src="/al-folio/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

    
  </body>
</html>
